name: Auth Middleware
tag: requires-auth

description: |
  Protected endpoints must verify a Bearer JWT token from the
  Authorization header. Return 401 if missing or invalid.
  Use the shared verifyToken() helper from auth/token-service.

requirements:
  - "Check Authorization header for Bearer <token>"
  - "Verify JWT signature and expiration"
  - "Attach decoded user to request context"
  - "Return 401 Unauthorized if token is invalid or missing"
